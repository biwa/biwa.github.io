<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Getting started - UDBScript</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Getting started";
    var mkdocs_page_input_path = "gettingstarted.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> UDBScript</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">UDBScript</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="..">Index</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Getting started</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#directory-structure">Directory structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#setting-hotkeys-to-execute-scripts">Setting hotkeys to execute scripts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#setting-up-an-external-script-editor">Setting up an external script editor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#the-docker">The docker</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#writing-scripts">Writing scripts</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#script-metadata">Script metadata</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#setting-script-options">Setting script options</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#accessing-script-options-in-a-script">Accessing script options in a script</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#the-global-udb-namespace">The global UDB namespace</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#working-with-vectors">Working with vectors</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#vector-arithmetic">Vector arithmetic</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#working-with-map-elements">Working with map elements</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#creating-new-geometry">Creating new geometry</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ending-scripts-prematurely">Ending scripts prematurely</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#communicating-with-the-user">Communicating with the user</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../changes/">Changes</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Angle2D/">Angle2D</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Data/">Data</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../GameConfiguration/">GameConfiguration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ImageInfo/">ImageInfo</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Line2D/">Line2D</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Linedef/">Linedef</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Map/">Map</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../QueryOptions/">QueryOptions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Sector/">Sector</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Sidedef/">Sidedef</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Thing/">Thing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../UDB/">UDB</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vector2D/">Vector2D</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vector3D/">Vector3D</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vertex/">Vertex</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../VisualCamera/">VisualCamera</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Built-in libraries</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Pen/">Pen</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">UDBScript</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>UDBScript &raquo;</li>
        
      
    
    <li>Getting started</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="getting-started">Getting started</h1>
<h2 id="introduction">Introduction</h2>
<p>UDBScript allows the user to run custom JavaScript code on the currently opened map. This allowes the user to modify existing map elements (like things or sectors), or to create completely new map elements (i.e. drawing lines, adding things etc.).</p>
<p>This guide only shows the intricacies of UDBScript and doesn't teach JavaScript. If you need a JavaScript tutorial please use your favourite search engine. UDBScript also comes with a variety of well-documented example scripts to study.</p>
<p>UDBScript uses the <a href="https://github.com/sebastienros/jint">Jint</a> interpreter.</p>
<h2 id="directory-structure">Directory structure</h2>
<p>Scripts are automatically found if they are placed in the correct directory structure. The directory structure is in the UDB installation folder and looks like this:</p>
<pre><code>.\UDBScript\
.\UDBScript\Libraries\
.\UDBScript\Scripts\
</code></pre>
<p>All files ending on .js in the <code>Libraries</code> directory are loaded (parsed and executed) every time a script is run. It is used to provide common functionality to multiple script. Currently there's the Pen.js library file that simplifies drawing geometry (it's inspired by the DBX Lua Pen class).</p>
<p>All files ending on .js in the <code>Scripts</code> directory (and its subdirectories) are added to the Scripts docker. They are only run on the user's command.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>UDBScript does hot reloading, i.e. changes to the scripts, or copying new scripts into the directory structure will be shown immediately.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>UDBScript comes with multiple example scripts in the <code>.\UDBScript\Scripts\Examples</code> directory. Do not modify those scripts, since they will be overwritten when UDB is updated. If you want to use one of the example scripts as a bas copy it to another directory!</p>
</div>
<h2 id="setting-hotkeys-to-execute-scripts">Setting hotkeys to execute scripts</h2>
<p>Hotkeys to execute scripts can be set by going to <code>Tools</code> -&gt; <code>Preferences</code> -&gt; <code>Controls</code>, and then filtering by <code>execute</code>.</p>
<p>You can set a hotkey to "Execute Script", which will execute the currently selected script in the docker (see <a href="#the-docker">The docker</a>), or up to 30 hotkeys to the "Execute Script Slot <em>x</em>", which will execute the script in the corrosponding slots (see <a href="#the-docker">The docker</a>).</p>
<p><img alt="Setting a hokey" src="../preferences.png" /></p>
<h2 id="setting-up-an-external-script-editor">Setting up an external script editor</h2>
<p>It is possible to set up an external script editor to edit the script from within UDB. To do so you have to open the preferences and go to the UDBScript tab (you probably have to scroll the tabs). It defaults to notepad.exe, but it's recommended to set it to an editor that supports syntax highlighting.</p>
<p><img alt="External editor setup" src="../externaleditor.png" /></p>
<h2 id="the-docker">The docker</h2>
<p>Scripts can be accessed, configured, and run through the provided docker. Selecting a script will show it's description (if available) and configuration options. </p>
<p>Default values in the script options will be shown in gray, deviating values as black. Pressing the <code>Reset</code> button will reset all values to their defaults. </p>
<p>Scripts can either be run using the <code>Run</code> button, or by pressing the assigned key (see <a href="#setting-hotkeys-to-execute-scripts">Setting hotkeys to execute scripts</a>). Note that scripts might rely on the mouse cursor being somewhere in the map space, in which case they will not run correctly using the <code>Run</code> button. This should be intercepted by the script.</p>
<p><img alt="The docker" src="../docker.png" /></p>
<p>You can open a context menu for each script by right-clicking on it. In the context menu you can either chose to edit the script, or to assign the script to one of the script slots. Assigning the script to a script slot allows you to execute the script by pressing the hotkey you assigned to the script slot (see <a href="#setting-hotkeys-to-execute-scripts">Setting hotkeys to execute scripts</a>).</p>
<p><img alt="The context menu" src="../contextmenu.png" /></p>
<h2 id="writing-scripts">Writing scripts</h2>
<h3 id="script-metadata">Script metadata</h3>
<p>Scripts can contain metadata at the top of the file to provide information about the script as well as available script options. The metadata is specified as JavaScript template strings, i.e. strings enclosed by backticks (<code>`</code>). The template string has to start with a <code>#</code>, followed by a command, followed by the payload, followed by a <code>;</code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The template string <strong>has</strong> to be followed by a <code>;</code>. All script metadata has to be at the top of the file and may not be interrupted by any other constructs (like variable declaraion or assignment). If such constructs are detected parsing of the metadata will stop.</p>
</div>
<p>Example:</p>
<pre><code class="language-js">`#version 2`;

`#name Super Useful Script`;

`#description This script does something really, really useful.`;
</code></pre>
<p>Currently the following metadata commands are available:</p>
<ul>
<li><code>version</code>: the feature version the script needs to run. Properties and methods that require a specific version are noted as such in the API documentation. If omitted version 1 is assumed. If the script requires a higher feature version than the user's UDBScript feature version the user will be asked if they want to execute the script anyway. If the user choses to execute the script this choice will be remembered for the session</li>
<li><code>name</code>: name of the script that will be shown in the docker. If omitted the capitalized file name without the extension will be used as the script name</li>
<li><code>description</code>: description of the script. Should include what the script does and what the requirements are (for example if something has to be selected for the script to work)</li>
<li><code>scriptoptions</code>: the script options. The payload has to be in UDB's configuration file format (see below)</li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>It is highliy recommended to set the feature version through the <code>version</code> metadata command. The global <code>UDB</code> namespace was added in version 4, and new features will be exclusively added to this namespace!</p>
</div>
<h4 id="setting-script-options">Setting script options</h4>
<p>The script options that can be set in the docker prior to running the script can be defined using the <code>scriptoptions</code> metadata command. The payload has to be in UDB's configuration file format.</p>
<p>The payload consists of one or more blocks, each defining an option. The blocks have the following format:</p>
<pre><code class="language-js">`#scriptoptions

&lt;name&gt;
{
    description = &lt;description&gt;;
    default = &lt;defaultvalue&gt;;
    type = &lt;type&gt;;
    enumvalues {
        &lt;values&gt;
    }
}
`;
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>The <code>eunumvalues</code> field is only used with the appropriate <code>type</code> value</li>
</ul>
</div>
<p>Example:</p>
<pre><code class="language-js">`#scriptoptions

length
{
    description = &quot;Length of closet&quot;;
    default = 256;
    type = 0; // Integer
}

direction
{
    description = &quot;Direction of closet&quot;;
    default = 0; // North
    type = 11; // Enum
    enumvalues {
        0 = &quot;North&quot;;
        1 = &quot;East&quot;;
        2 = &quot;South&quot;;
        3 = &quot;West&quot;;
    }
}
`;
</code></pre>
<p>You can also write the options in a more compact form:</p>
<pre><code class="language-js">`#scriptoptions

width  { description = &quot;Width of the sector&quot;;  type = 0; default = 256; }
height { description = &quot;Height of the sector&quot;; type = 0; default = 512; }
`;
</code></pre>
<p>The following types are currently available:</p>
<ul>
<li>0: integer</li>
<li>1: floating point number</li>
<li>2: string</li>
<li>3: boolean</li>
<li>5: sector effect*</li>
<li>6: texture*</li>
<li>7: flat*</li>
<li>8: angle in degrees*</li>
<li>9: angle in radians*</li>
<li>10: color*</li>
<li>11: enumeration**</li>
<li>13: sector tag*</li>
<li>14: thing tag*</li>
<li>15: linedef tag*</li>
<li>17: angle in degrees as floating point number*</li>
<li>18: thing type*</li>
<li>19: thing class*</li>
<li>22: byte angle*</li>
<li>25: PolyObject number*</li>
</ul>
<p>&ast; these are quality of life type for interger, floating point numbers, and strings. Clicking into their field will show context sensitive controls. For example when using type 3 (boolean) there will be drop down list where you can choose between <code>true</code> or <code>false</code>, when using type 6 (texture) a button button that will open the texture browser, when using type 13 (sector tag) will show a drop down list of sector tags in the map etc.<br><img alt="Script option quality of life button" src="../scriptoptions.png" /></p>
<h4 id="accessing-script-options-in-a-script">Accessing script options in a script</h4>
<p>The script option can be accessed through the <code>ScriptOptions</code> object in the global <code>UDB</code> namespace. This object has properties by the name of the blocks of the script option definition, and contains the value set in the docker.</p>
<p>Example:</p>
<pre><code class="language-js">`#scriptoptions

length
{
    description = &quot;Length of closet&quot;;
    default = 256;
    type = 0; // Integer
}
`;

UDB.showMessage('The given length is ' + UDB.ScriptOptions.length);
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can also query options at runtime. See the <code>QueryOptions</code> API documentation.</p>
</div>
<h3 id="the-global-udb-namespace">The global UDB namespace</h3>
<p>Starting with feature version 4 of UDBScript all objects, methods, and classes are combined in the global <code>UDB</code> namespace. This is to prevent clashes with existing and future features of Javascript (for example Javascript has a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map">Map</a> class). It is highly recommended to specify the feature version through the <code>version</code> metadata command (see above). New UDBScript features will only be added to the global <code>UDB</code> namespace.</p>
<p>In practice that means that all methods, objects, and classes have to be prefixed with <code>UDB.</code>, for example getting all sectors in a map looked like this in versions prior to 4:</p>
<pre><code class="language-js">let sectors = Map.getSectors();
</code></pre>
<p>while in version 4 and later the following code has to be used:</p>
<pre><code class="language-js">let sectors = UDB.Map.getSectors();
</code></pre>
<h3 id="working-with-vectors">Working with vectors</h3>
<p>In UDBScript vectors are commonly used to represent positions, like thing and vertex positions. They come in two flavors, <code>Vector2D</code> (representing a two-dimentional vector with <code>x</code> and <code>y</code> components) and <code>Vector3D</code> (representing a three-dimentional vector with <code>x</code>, <code>y</code>, and <code>z</code> components). They feature a range of vector math methods, such as rotating the vector.</p>
<p>There are several ways to create a new vector:</p>
<pre><code class="language-js">let v1 = new UDB.Vector2D(32, 64); // From x and y values
let v2 = new UDB.Vector2D([ 32, 64 ]); // From an array with two numbers
let v3 = new UDB.Vector2D({ x: 32, y: 64 }); // From an object with x and y properties
let v4 = new UDB.Vector2D(v1); // From another Vector2D

let v5 = new UDB.Vector3D(32, 64, 16); // From x, y, and z values
let v6 = new UDB.Vector3D([ 32, 64, 16 ]); // From an array with three numbers
let v7 = new UDB.Vector3D({ x: 32, y: 64, z: 16 }); // From an object with x, y, and z properties
let v8 = new UDB.Vector3D(v5); // From another Vector3D
</code></pre>
<p>API methods that accept a <code>Vector2D</code> or <code>Vector3D</code> as a parameter also accept the array notation. For example the following lines are equivalent:</p>
<pre><code class="language-js">let t1 = UDB.Map.createThing(new UDB.Vector2D(32, 64), 3001); // Create an Imp
let t2 = UDB.Map.createThing([ 32, 64 ], 3001); // Create an Imp
let t3 = UDB.Map.createThing({ x: 32, y: 64 }, 3001); // Create an Imp

let v = new UDB.Vector2D(32, 64); // Supplying the x and y values
let t4 = UDB.Map.createThing(v, 3001); // Create an Imp
</code></pre>
<h4 id="vector-arithmetic">Vector arithmetic</h4>
<p>It is possible to do elementary arithmetic with vectors, i.e. you can add, substract, multiply, and divide them.</p>
<pre><code class="language-js">let v1 = new UDB.Vector2D(2, 3) + new UDB.Vector2D(4, 5); // Results in new Vector(6, 8)
let v2 = new UDB.Vector2D(2, 3) - new UDB.Vector2D(4, 5); // Results in new Vector(-2, -2)
let v3 = new UDB.Vector2D(2, 3) * new UDB.Vector2D(4, 5); // Results in new Vector(8, 15)
let v4 = new UDB.Vector2D(2, 3) / new UDB.Vector2D(4, 5); // Results in new Vector(0.5, 0.6)
</code></pre>
<p>This also works with the array and object notation:</p>
<pre><code class="language-js">let v1 = new UDB.Vector2D(2, 3) + [ 4, 5 ]; // Results in new Vector(6, 8)
let v2 = new UDB.Vector2D(2, 3) + { x: 4, y: 5 }; // Results in new Vector(6, 8)
</code></pre>
<p>You can also use only a number as one side of the operation, in  which case the operation will be applied to each element of the vector:</p>
<pre><code class="language-js">let v1 = new UDB.Vector2D(2, 3) + 3; // Results in new Vector(5, 6)
let v2 = new UDB.Vector2D(2, 3) * 3; // Results in new Vector(6, 9)
</code></pre>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Vector arithmetic only works if either side of arithmetic operation is of type <code>Vector2D</code> or <code>Vector3D</code>. That means that for example the following code will <em>not</em> result in a vector:<br>
<code>let v1 = [ 2, 3 ] + [ 4, 5 ]; // Results in the string "2, 34, 5"</code></p>
</div>
<h3 id="working-with-map-elements">Working with map elements</h3>
<p>Map elements (things, sectors, linedefs, sidedefs, vertices) can be accessed through the <code>UDB.Map</code> object. This object has methods that return an array of map elements, for example <code>UDB.Map.getSectors()</code> returns an array of <code>Sector</code> objects, which are are all sectors in the map. There are also methods to get all selected (for example <code>UDB.Map.getSelectedSectors()</code>) and marked (for example <code>UDB.Map.getMarkedSectors()</code>), or the currently highlighted (for example <code>UDB.Map.getHighlightedSector()</code>) map elements. There are also methods to get either the currently selected map elements, <em>or</em> the currently highlighted map elements (for example <code>UDB.Map.getSelectedOrHighlightedSectors()</code>). These map elements can then be modified, see the documentation for the particular map element type in the API section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>"Marking" a map element is a way to denote that something happened to this map element. For example when using the <code>UDB.Map.drawLines()</code> method all new geometry will be marked.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>UDB differentiates between "selecting" and "highlighting" map elements. "Selecting" means clicking on the map element, "highlighting" means just hovering the mouse on (or near) a map element. All the <code>UDB.Map.getSelectedOrHighlighted...()</code> methods behave like UDB usually works, i.e. if at least one map element is selected, the selected map elements will be returned (and the highlighted map element will be ignored), if no map elements are selected the highlighted map element will be returned.
In most circumstances it is recommended to use the <code>UDB.Map.getSelectedOrHighlighted...()</code> to stay close to UDB's built-in actions.</p>
</div>
<h3 id="creating-new-geometry">Creating new geometry</h3>
<p>New map geometry can be created with the <code>drawLines()</code> method of the <code>UDB.Map</code> object. It accepts an array of coordinates in map space. The coordinates can either by instances of <code>Vector2D</code>, <code>Vector3D</code>, or an array of numbers.</p>
<p>Example 1:</p>
<pre><code class="language-js">UDB.Map.drawLines([
    new UDB.Vector2D(0, 0),
    new UDB.Vector2D(64, 0),
    new UDB.Vector2D(64, 64),
    new UDB.Vector2D(0, 64),
    new UDB.Vector2D(0, 0)
]);
</code></pre>
<p>Example 2:</p>
<pre><code class="language-js">UDB.Map.drawLines([
    [ 0, 0 ],
    [ 64, 0 ],
    [ 64, 64 ],
    [ 0, 64 ],
    [ 0, 0 ]
]);
</code></pre>
<p>Both examples are equivalent. The advantage of using <code>Vector2D</code> or <code>Vector3D</code> is that they have many math related methods built-in.</p>
<p>Another method to draw geometry is using the <code>Pen</code> class - which itself is implemented as a library written in JavaScript. It's inspired by the DoomBuilder X class of the same name. It provides some quality of life features, since it creates coordinates relative to the current position - just like moving a pen around a sheet of paper, or <a href="https://en.wikipedia.org/wiki/Turtle_graphics">Turtle graphics</a>.</p>
<p>Naive implementation of the above example using the <code>Pen</code> class:</p>
<pre><code class="language-js">let p = new Pen();
p.moveTo([0, 0]);
p.drawVertex();
p.moveTo([64, 0]);
p.drawVertex();
p.moveTo([64, 64]);
p.drawVertex();
p.moveTo([0, 64]);
p.drawVertex();
p.finishDrawing();
</code></pre>
<p>Using the strenghts of the <code>Pen</code> class:</p>
<pre><code class="language-js">let p = new Pen([0, 0]);

for(let i=0; i &lt; 4; i++)
{
    p.drawVertex();
    p.moveForward(64);
    p.turnRight();
}

p.finishDrawing();
</code></pre>
<h3 id="ending-scripts-prematurely">Ending scripts prematurely</h3>
<p>Normally a script ends when the last instruction is executed. But there can be situations where you want to end a script early.</p>
<ul>
<li><code>UDB.exit()</code>: this global function ends the script with success. It can optionally take a string argument that is shown in the status bar upon ending the script</li>
<li><code>UDB.die()</code>: this global function ends the script with a failure. This means that it will undo any changes the script has made. It can optionally take a string argument that is shown in the status bar upon ending the script</li>
<li><code>throw</code>: throws an exception. Only ends the script if it's not caught in a <code>try</code>/<code>catch</code> block. If not caught it'll end the script with a failure. This means that it will undo any changes the script has made. The string given as a parameter is shown in the status bar upon ending the script</li>
</ul>
<pre><code class="language-js">let sectors = UDB.Map.getSelectedSectors();

if(sectors.length == 0)
    UDB.die('You have to select at least one sector');

UDB.exit('There were ' + sectors.length + ' sectors selected');

throw 'This part of the script should never be reached!';
</code></pre>
<h3 id="communicating-with-the-user">Communicating with the user</h3>
<p>Sometimes you might want to let the script directly communicate with the user. To do that there are two functions, <code>UDB.showMessage()</code> and <code>UDB.showMessageYesNo()</code>.</p>
<ul>
<li><code>UDB.showMessage()</code>: shows a message box with an "OK" button and the text given as the parameter<br></li>
</ul>
<pre><code class="language-js">UDB.showMessage('Hello, world!');
</code></pre>
<ul>
<li><code>UDB.showMessageYesNo()</code>: shows a message box with an "Yes" and "No" button and the text given as the parameter. Returns <code>true</code> if the "Yes" button was clicked, and <code>false</code> if the "No" button was clicked</li>
</ul>
<pre><code class="language-js">if(UDB.showMessageYesNo('Are you sure you want to replace all imps with Arch-Viles? That\'s not remotely fair!'))
{
    UDB.Map.getThings().filter(t =&gt; t.type == 3001).forEach(t =&gt; t.type=64);
}
</code></pre>
<p>For long-running scripts it's also possible to report the progress to the user using the <code>UDB.setProgress()</code> method, which accepts values from 0 to 100. For example the following code will set the progress bar to 25%:</p>
<pre><code class="language-js">UDB.setProgress(25);
</code></pre>
<p>Additional output can be shown using the <code>UDB.log()</code> method, which will add a line of text to the log in the running script dialog:</p>
<pre><code class="language-js">UDB.log('Hello, world!');
</code></pre>
<p><img alt="Running Script Dialog" src="../runningscriptdialog.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../changes/" class="btn btn-neutral float-right" title="Changes">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Index"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../changes/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
